<div class="view-others-container">
  <header class="header">
    <h1>ğŸ„ Other Family Lists</h1>
    <div class="user-info">
      <span>Welcome, {{ userEmail }}! ğŸ„</span>
      <button (click)="signOut()" class="btn-signout">Switch User</button>
    </div>
  </header>

  <div class="navigation-buttons">
    <button (click)="goToChoice()" class="btn-nav">â† Back to Menu</button>
    <button (click)="goToMyList()" class="btn-nav">My List</button>
  </div>

  <!-- Skip to Person Section -->
  <div *ngIf="!loading && Object.keys(groupedItems).length > 1" 
       #skipToSection
       class="skip-to-section">
    <label for="skipToSelect">Skip to:</label>
    <select 
      id="skipToSelect" 
      class="skip-to-select"
      (change)="onSkipToChange($event)">
      <option value="" disabled selected>Choose a person...</option>
      <option 
        *ngFor="let person of getPeopleList()" 
        [value]="person.userId">
        {{ person.userName }} ({{ person.itemCount }} items)
      </option>
    </select>
  </div>

  <div class="content">
    <div *ngIf="loading" class="loading">
      <p>Loading family lists... ğŸ</p>
    </div>

    <div *ngIf="!loading && Object.keys(groupedItems).length === 0" class="empty-state">
      <p>No other family lists found yet! ğŸ„</p>
      <p>Other family members haven't added items to their lists yet.</p>
      <p>You can add items to your own list and come back later!</p>
    </div>

    <div *ngIf="!loading && Object.keys(groupedItems).length > 0" class="lists-container">
      <div *ngFor="let userId of Object.keys(groupedItems)" 
           [id]="'user-list-' + userId"
           class="user-list-section">
        <div class="user-header">
          <h2>{{ groupedItems[userId].userName }}'s Wish List</h2>
          <span class="item-count">({{ groupedItems[userId].items.length }} items)</span>
        </div>

        <div class="items-grid">
          <div 
            *ngFor="let item of groupedItems[userId].items" 
            class="item-card"
            [class.purchased]="item.purchased">
            
          <!-- Column 1: Image -->
          <div *ngIf="item.picture" class="item-picture">
            <img [src]="item.picture" [alt]="item.name" class="item-image" (error)="onImageError($event)" (click)="openImageModal(item.picture, item.name)">
          </div>
            
            <!-- Column 2: Content -->
            <div class="item-content">
              <h4 class="item-title">{{ item.name }}</h4>
              <div class="item-meta">
                <span *ngIf="item.store" class="store">{{ item.store }}</span>
                <span *ngIf="item.price" class="price">${{ item.price | number:'1.2-2' }}</span>
              </div>
              <div *ngIf="item.purchaseUrl" class="purchase-link">
                <a [href]="item.purchaseUrl" target="_blank" class="btn-buy">
                  ğŸ›’ Buy Now
                </a>
              </div>
              <div *ngIf="item.purchased && item.purchasedBy" class="purchased-by">
                Purchased by: {{ item.purchasedBy }}
              </div>
            </div>
            
            <!-- Column 3: Actions -->
            <div class="item-actions">
              <button 
                (click)="togglePurchased(item)" 
                class="btn-toggle"
                [class.purchased]="item.purchased">
                {{ item.purchased ? 'âœ“' : 'â—‹' }}
              </button>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Image Modal -->
  <div *ngIf="selectedImage" class="image-modal" (click)="closeImageModal()">
    <div class="image-modal-content" (click)="$event.stopPropagation()">
      <button class="image-modal-close" (click)="closeImageModal()">&times;</button>
      <img [src]="selectedImage.src" [alt]="selectedImage.alt" class="image-modal-img">
      <div class="image-modal-caption">{{ selectedImage.alt }}</div>
    </div>
  </div>
</div>
